{"version":3,"sources":["utils/index.ts","utils/http.ts","utils/use-async.ts","components/profiler.tsx","components/error-boundary.tsx","App.tsx","reportWebVitals.ts","context/index.tsx","index.tsx","auth-provider.ts","components/lib.tsx","context/auth-context.tsx"],"names":["cleanObject","obj","result","Object","keys","forEach","key","value","undefined","isVoid","Reflect","deleteProperty","useMount","callback","useEffect","useDebounce","delay","useState","debouncedValue","setDebouncedValue","timer","setTimeout","clearTimeout","useDocumentTitle","title","keepOnUnmount","oldTitle","useRef","document","current","resetRoute","window","location","href","origin","useMountedRef","mountedRef","apiUrl","process","http","endpoint","a","data","token","headers","customconfig","config","method","Authorization","toUpperCase","qs","stringify","body","JSON","fetch","then","res","status","auth","reload","Promise","reject","message","json","ok","useHttp","user","useAuth","useCallback","defaultInitialState","stat","error","defaultConfig","throwOnError","useAsync","initialState","initialConfig","useReducer","state","action","asyncReducer","safeDispatch","dispatch","useSafeDipstach","retry","setRetry","setData","setError","run","promise","runConfig","Error","catch","isIdle","isLoading","isError","isSuccess","queue","setInterval","length","queueToSend","console","log","Profiler","metadata","phases","props","onRender","id","phase","actualDuration","baseDuration","startTime","commitTime","interactions","includes","push","ErrorBoundary","this","fallbackRender","children","React","Component","AuthenticatedApp","lazy","UnauthenticatedApp","App","className","FullPageErrorCallBack","Suspense","fallback","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","AppProviders","client","QueryClient","loadServer","ReactDOM","render","getElementById","localStorageKey","getToken","localStorage","getItem","handleUserResponse","setItem","login","response","register","logout","removeItem","Row","styled","div","between","marginBottom","gap","FullPage","FullPageLoading","size","ErrorBox","ButtonNoPadding","Button","Text","type","ScreenContainer","bootstrapUser","AuthContext","createContext","displayName","AuthProvider","setUser","queryClient","useQueryClient","Provider","form","clear","context","useContext"],"mappings":"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","file":"static/js/main.4a7eb788.chunk.js","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\n\nexport const isVoid = (value: unknown) =>\n  value === undefined || value === null || value === \"\";\nexport const cleanObject = (obj: { [key: string]: unknown }) => {\n  let result = { ...obj };\n  Object.keys(result).forEach((key) => {\n    const value = result[key];\n    if (isVoid(value)) {\n      Reflect.deleteProperty(result, key);\n    }\n  });\n  return result;\n};\n\nexport const useMount = (callback: () => void) => {\n  useEffect(() => {\n    callback();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n\n// 泛型\nexport const useDebounce = <V>(value: V, delay?: number) => {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(() => {\n    const timer = setTimeout(() => setDebouncedValue(value), delay);\n    return () => clearTimeout(timer);\n  }, [value, delay]);\n  return debouncedValue;\n};\nexport type UserArr = { name: string; age: number };\n\nexport const useArray = <T>(value: T[]) => {\n  const [arr, setArr] = useState(value);\n  function add(obj: T) {\n    setArr([...arr, obj]);\n  }\n  function clear() {\n    setArr([]);\n  }\n  function removeIndex(index: number) {\n    let newArr = arr.filter((val, idx) => idx !== index);\n    setArr(newArr);\n  }\n  return { value: arr, add, clear, removeIndex };\n};\n\nexport const useDocumentTitle = (\n  title: string,\n  keepOnUnmount: boolean = true\n) => {\n  const oldTitle = useRef(document.title).current;\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n  useEffect(() => {\n    return () => {\n      if (!keepOnUnmount) {\n        document.title = oldTitle;\n      }\n    };\n  }, [keepOnUnmount, oldTitle]);\n};\n\nexport const resetRoute = () => (window.location.href = window.location.origin);\n\n/**\n * 返回组件的挂载状态，如果还没挂载或者已经卸载，返回false，否则返回true\n */\n\nexport const useMountedRef = () => {\n  const mountedRef = useRef(false);\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  });\n  return mountedRef;\n};\n","import qs from \"qs\";\nimport * as auth from \"auth-provider\";\nimport { useAuth } from \"context/auth-context\";\nimport { useCallback } from \"react\";\n\ninterface Config extends RequestInit {\n  token?: string;\n  data?: object;\n}\n\nconst apiUrl = process.env.REACT_APP_API_URL;\nexport const http = async (\n  endpoint: string,\n  { data, token, headers, ...customconfig }: Config = {}\n) => {\n  const config = {\n    method: \"GET\",\n    headers: {\n      Authorization: token ? `Bearer ${token}` : \"\",\n      \"Content-Type\": data ? \"application/json\" : \"\",\n    },\n    ...customconfig,\n  };\n  if (config.method.toUpperCase() === \"GET\") {\n    endpoint += `?${qs.stringify(data)}`;\n  } else {\n    config.body = JSON.stringify(data || {});\n  }\n  return window.fetch(`${apiUrl}/${endpoint}`, config).then(async (res) => {\n    if (res.status === 401) {\n      await auth.logout();\n      window.location.reload();\n      return Promise.reject({ message: \"Pls login again\" });\n    }\n    const data = await res.json();\n    if (res.ok) return data;\n    else return Promise.reject(data);\n  });\n};\n\nexport const useHttp = () => {\n  const { user } = useAuth();\n  // Utility Types\n  // 这个typeof是静态的，与JS中不一样\n  return useCallback(\n    (...[endpoint, config]: Parameters<typeof http>) =>\n      http(endpoint, { ...config, token: user?.token }),\n    [user?.token]\n  );\n};\n","import { useCallback, useReducer, useState } from \"react\";\nimport { useMountedRef } from \"utils\";\n\ninterface State<D> {\n  error: Error | null;\n  data: D | null;\n  stat: \"idle\" | \"loading\" | \"error\" | \"success\";\n}\n\nconst defaultInitialState: State<null> = {\n  stat: \"idle\",\n  data: null,\n  error: null,\n};\n\nconst defaultConfig = {\n  throwOnError: false,\n};\n\n// reducer\nconst asyncReducer = <D>(state: State<D>, action: Partial<State<D>>) => ({\n  ...state,\n  ...action,\n});\n\nconst useSafeDipstach = <T>(dispatch: (...args: T[]) => void) => {\n  const mountedRef = useMountedRef();\n  return useCallback(\n    (...args: T[]) => (mountedRef.current ? dispatch(...args) : void 0),\n    [dispatch, mountedRef]\n  );\n};\n\nexport const useAsync = <D>(\n  initialState?: State<D>,\n  initialConfig?: typeof defaultConfig\n) => {\n  const config = { ...defaultConfig, initialConfig };\n  // 这样就会正常\n  // const [state, dispatch] = useReducer(\n  //   (state: State<D>, action: Partial<State<D>>) => ({\n  //     ...state,\n  //     ...action,\n  //   }),\n  //   {\n  //     ...defaultInitialState,\n  //     ...initialState,\n  //   }\n  // );\n\n  //为什么这样写就可以了呢\n  const [state, dispatch] = useReducer(\n    (state: State<D>, action: Partial<State<D>>) => asyncReducer(state, action),\n    {\n      ...defaultInitialState,\n      ...initialState,\n    }\n  );\n  // 把reducer抽出来写就会报错 reducer在上面20行👆\n  // const [state, dispatch] = useReducer(asyncReducer, {\n  //   ...defaultInitialState,\n  //   ...initialState,\n  // });\n\n  const safeDispatch = useSafeDipstach(dispatch);\n  const [retry, setRetry] = useState(() => () => {});\n  const setData = useCallback(\n    (data: D) =>\n      safeDispatch({\n        data,\n        stat: \"success\",\n        error: null,\n      }),\n    [safeDispatch]\n  );\n  const setError = useCallback(\n    (error: Error) =>\n      safeDispatch({\n        error,\n        stat: \"error\",\n        data: null,\n      }),\n    [safeDispatch]\n  );\n  const run = useCallback(\n    (promise: Promise<D>, runConfig?: { retry: () => Promise<D> }) => {\n      if (!promise || !promise.then) {\n        throw new Error(\"Promise type needed!\");\n      }\n      setRetry(() => () => {\n        if (runConfig?.retry) {\n          run(runConfig?.retry(), runConfig);\n        }\n      });\n      safeDispatch({ stat: \"loading\" });\n      return promise\n        .then((data) => {\n          setData(data);\n          return data;\n        })\n        .catch((error) => {\n          setError(error);\n          if (config.throwOnError) return Promise.reject(error);\n          return error;\n        });\n    },\n    [config.throwOnError, setData, setError, safeDispatch]\n  );\n\n  return {\n    isIdle: state.stat === \"idle\",\n    isLoading: state.stat === \"loading\",\n    isError: state.stat === \"error\",\n    isSuccess: state.stat === \"success\",\n    run,\n    setData,\n    setError,\n    retry,\n    ...state,\n  };\n};\n","import React, { ProfilerOnRenderCallback, ProfilerProps } from \"react\";\n\ntype Props = { metadata?: any; phases?: (\"mount\" | \"update\")[] } & Omit<\n  ProfilerProps,\n  \"onRender\"\n>;\n\nlet queue: unknown[] = [];\n\nconst sendProfileQueue = () => {\n  if (!queue.length) {\n    return;\n  }\n  const queueToSend = [...queue];\n  queue = [];\n  console.log(queueToSend);\n};\n\nsetInterval(sendProfileQueue, 5000);\n\nexport const Profiler = ({ metadata, phases, ...props }: Props) => {\n  const reportProfile: ProfilerOnRenderCallback = (\n    id,\n    phase,\n    actualDuration,\n    baseDuration,\n    startTime,\n    commitTime,\n    interactions\n  ) => {\n    if (!phases || phases.includes(phase)) {\n      queue.push({\n        id,\n        phase,\n        actualDuration,\n        baseDuration,\n        startTime,\n        commitTime,\n        interactions,\n        metadata,\n      });\n    }\n  };\n\n  return <React.Profiler onRender={reportProfile} {...props} />;\n};\n","import React, { ReactNode } from \"react\";\n\ntype FallbackRender = (props: { error: Error | null }) => React.ReactElement;\n\n// https://github.com/byaughn/react-error-boundary\n\nexport class ErrorBoundary extends React.Component<\n  React.PropsWithChildren<{ fallbackRender: FallbackRender }>,\n  { error: Error | null }\n> {\n  state = { error: null };\n\n  static getDerivedStateFromError(error: Error) {\n    return { error };\n  }\n\n  render(): ReactNode {\n    const { error } = this.state;\n    const { fallbackRender, children } = this.props;\n    if (error) {\n      return fallbackRender({ error });\n    }\n    return children;\n  }\n}\n","import React from \"react\";\nimport { ErrorBoundary } from \"components/error-boundary\";\nimport { useAuth } from \"context/auth-context\";\nimport { FullPageErrorCallBack, FullPageLoading } from \"components/lib\";\nimport \"./App.css\";\n\nconst AuthenticatedApp = React.lazy(() => import(\"authenticated-app\"));\nconst UnauthenticatedApp = React.lazy(() => import(\"unauthenticated-app\"));\n\nfunction App() {\n  const { user } = useAuth();\n  return (\n    <div className=\"App\">\n      <ErrorBoundary fallbackRender={FullPageErrorCallBack}>\n        <React.Suspense fallback={<FullPageLoading />}>\n          {user ? <AuthenticatedApp /> : <UnauthenticatedApp />}\n        </React.Suspense>\n      </ErrorBoundary>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport { ReactNode } from \"react\";\nimport { AuthProvider } from \"./auth-context\";\nimport { QueryClientProvider, QueryClient } from \"react-query\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nexport const AppProviders = ({ children }: { children: ReactNode }) => {\n  return (\n    <QueryClientProvider client={new QueryClient()}>\n      <Router>\n        <AuthProvider>{children}</AuthProvider>\n      </Router>\n    </QueryClientProvider>\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./wdyr.ts\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { loadServer, DevTools } from \"jira-dev-tool\";\nimport { AppProviders } from \"context\";\nimport \"antd/dist/antd.less\";\nimport { Profiler } from \"components/profiler\";\n// const root = ReactDOM.createRoot(\n//   document.getElementById(\"root\") as HTMLElement\n// );\n// root.render(<App />);\nloadServer(() =>\n  ReactDOM.render(\n    <AppProviders>\n      <DevTools />\n      <Profiler id=\"Root App\" phases={[\"mount\"]}>\n        <App />\n      </Profiler>\n    </AppProviders>,\n    document.getElementById(\"root\")\n  )\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { User } from \"types\";\n\nconst apiUrl = process.env.REACT_APP_API_URL;\n\nconst localStorageKey = \"__auth_provider_token__\";\n\nexport const getToken = () => window.localStorage.getItem(localStorageKey);\n\nexport const handleUserResponse = ({ user }: { user: User }) => {\n  window.localStorage.setItem(localStorageKey, user.token || \"\");\n  return user;\n};\n\nexport const login = (data: { username: string; password: string }) => {\n  return fetch(`${apiUrl}/login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(data),\n  }).then(async (response) => {\n    if (response.ok) {\n      return handleUserResponse(await response.json());\n    } else {\n      return Promise.reject(await response.json());\n    }\n  });\n};\n\nexport const register = (data: { username: string; password: string }) => {\n  return fetch(`${apiUrl}/register`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(data),\n  }).then(async (response) => {\n    if (response.ok) {\n      return handleUserResponse(await response.json());\n    } else {\n      return Promise.reject(await response.json());\n    }\n  });\n};\n\nexport const logout = async () =>\n  window.localStorage.removeItem(localStorageKey);\n","import styled from \"@emotion/styled\";\nimport { Spin, Typography, Button } from \"antd\";\nimport { DevTools } from \"jira-dev-tool\";\nexport const Row = styled.div<{\n  gap?: number | boolean;\n  between?: boolean;\n  marginBottom?: number;\n}>`\n  display: flex;\n  align-items: center;\n  justify-content: ${(props) => (props.between ? \"space-between\" : undefined)};\n  margin-bottom: ${(props) => props.marginBottom + \"rem\"};\n  > * {\n    margin-top: 0 !important;\n    margin-bottom: 0 !important;\n    margin-right: ${(props) =>\n      typeof props.gap === \"number\"\n        ? props.gap + \"rem\"\n        : props.gap\n        ? \"2rem\"\n        : undefined};\n  }\n`;\n\nconst FullPage = styled.div`\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\nexport const FullPageLoading = () => (\n  <FullPage>\n    <Spin size={\"large\"} />\n  </FullPage>\n);\n\nexport const FullPageErrorCallBack = ({ error }: { error: Error | null }) => (\n  <FullPage>\n    <DevTools />\n    <ErrorBox error={error} />\n  </FullPage>\n);\n\nexport const ButtonNoPadding = styled(Button)`\n  padding: 0;\n`;\n\n// 类型守卫\nconst isError = (value: any): value is Error => value?.message;\n\nexport const ErrorBox = ({ error }: { error: unknown }) => {\n  if (isError(error)) {\n    return <Typography.Text type=\"danger\">{error?.message}</Typography.Text>;\n  }\n  return null;\n};\n\nexport const ScreenContainer = styled.div`\n  padding: 3.2rem;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n","import React, { ReactNode } from \"react\";\nimport * as auth from \"auth-provider\";\nimport { User } from \"types\";\nimport { http } from \"utils/http\";\nimport { useMount } from \"utils\";\nimport { useAsync } from \"utils/use-async\";\nimport { FullPageErrorCallBack, FullPageLoading } from \"components/lib\";\nimport { useQueryClient } from \"react-query\";\n\ntype AuthForm = {\n  username: string;\n  password: string;\n};\n\nconst bootstrapUser = async () => {\n  let user = null;\n  const token = auth.getToken();\n  if (token) {\n    const data = await http(\"me\", { token });\n    user = data.user;\n  }\n  return user;\n};\nconst AuthContext = React.createContext<\n  | {\n      user: User | null;\n      login: (form: AuthForm) => Promise<void>;\n      register: (form: AuthForm) => Promise<void>;\n      logout: () => Promise<void>;\n    }\n  | undefined\n>(undefined);\nAuthContext.displayName = \"AuthContext\";\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const {\n    data: user,\n    error,\n    isLoading,\n    isIdle,\n    isError,\n    run,\n    setData: setUser,\n  } = useAsync<User | null>();\n  const queryClient = useQueryClient();\n  const login = (form: AuthForm) => auth.login(form).then(setUser);\n  const register = (form: AuthForm) => auth.register(form).then(setUser);\n  const logout = () =>\n    auth.logout().then(() => {\n      setUser(null);\n      queryClient.clear();\n    });\n\n  useMount(() => {\n    run(bootstrapUser());\n  });\n  if (isIdle || isLoading) {\n    return <FullPageLoading />;\n  }\n  if (isError) {\n    return <FullPageErrorCallBack error={error} />;\n  }\n\n  return (\n    <AuthContext.Provider\n      children={children}\n      value={{ user, login, register, logout }}\n    />\n  );\n};\nexport const useAuth = () => {\n  const context = React.useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"Please use useAuth inside AuthProvider\");\n  }\n  return context;\n};\n"],"sourceRoot":""}